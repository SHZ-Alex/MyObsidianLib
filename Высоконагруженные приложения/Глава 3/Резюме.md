В этой главе мы попытались разобраться в том, как БД хранят, извлекают данные. Что же происходит при сохранении данных в базе и что делает база, когда вы позднее делаете запрос.

На высоком уровне абстракции мы видим, что базы делятся на две широкие категории OLTP(оптимизированные на транзакции) и OLAP(оптимизированно для аналитиков). Между паттернами доступа есть большое различие.

1. OLPT рассчитаны на работу с пользователями и означает огромное потенциальное количество запросов. Программа записи затрагивает ключ, а подсистема хранения задействует индекс для поиска данных с соответствующим ключом. Узким место является время перехода к нужной позиции на диске.

2. Склады данных и подобные им аналитические системы менее широко известны, поскольку применяются бизнес-аналитиками. Склады обрабатывают намного меньше количество запросов, чем OLTP системы, но все запросы ресурсоемки и требуют просмотра миллионов строк за короткое время. Узким место является пропускная способность диска.


С точки зрения OLTP мы рассмотрели два различных подхода к подсистемам хранения.

1. Журналированый подход, при котором допускается только дописывание в файл и удаление устаревших файлов, а не обновление записанного файла.

2. Подход с обновлением на месте, при котором диск рассматривается как набор страниц заданного размера, допускающих перезапись. Крупнейший представитель этой философии - B-деревья, используемых в реляционных и нерляционных БД.

Журналирование подсистемы хранения - относительно недавнее изобретение. Основная идея состоит в систематическом преобразовании произвольной записи на диск в последовательную, что обеспечивает более высокую пропускную способность по записи вследствие характеристик производительности жестких дисков и твердотельных накопителей.

Заканчивая обзор OLTP-подхода мы вкратце рассмотрели более сложные индексные структуры, а также базы, оптимизированные для хранениях всех данных в оперативной памяти.

Далее мы перешли к рассмотрению внутреннего устройства подсистем хранения к высокоуровневой архитектуре типичного склада данных. Это позволило проиллюстрировать , почему аналитические задачи настолько отличаются от OLTP, когда требуется просмотреть миллионы строк, индексы не играют роли. Вместо этого становится гораздо важнее кодировать данные очень компактно. Вместо этого становится гораздо важнее кодировать данные очень компактно, чтобы минимизировать объем читаемых с диска данных. Мы обсудли, как столбцовые хранилища помогают решать эту задачу.

Вооружившись знаниями о внутреннем устройстве подсистем хранения, мы, как разработчики приложений, можем гораздо лучше разобраться в том, какой инструмент большое подойдет для вашего конкретного случая. Если вам понадобится настроить параметры БД, то эти знания позволят понять, что повлечет изменение параметра в большую или меньшую сторону.

Хотя эта глава и не сделала нас экспертами по БД, этого достаточно, чтобы разобраться дальше уже в нужней нам ситуации.