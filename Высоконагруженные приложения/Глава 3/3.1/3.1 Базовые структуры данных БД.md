Рассмотрим самую простую БД в мире, которую можно написать на Bash.

![[Pasted image 20250416231648.png]]

У нас будет одна функция на запись по ключу и значению, и функция на запросы по ключу.

Сама структура проста, в файле лежат пары ключ - значение, разделенный запятой, от части похоже на CSV файл. Каждый вызов функции db_set записывает новую строчку в конец файла. Так что при обновлении ключа несколько раз, старые значения затерты не будут. Для поиска потребуется найти самый последний ключ.

Производительность этой функции довольна неплохая, скорость на запись достаточно быстрая, обычно все БД имеют такой подход, правда БД чуть сложнее с конкурентным доступом, транзакций, возврат обращения на диске, но в целом все так же. Такие журналы очень удобные и еще не раз будут упомянуты.

---

Журнал -часто используют говоря, о журналах приложения, в которые программа вводит текст, описывающий выполняемые действия. Дальше оно будет применено в более общем смысле как последовательность записей, журнал редко удобочитаем для человека, обычно его записывают в двоичном виде и предназначен для чтения другими программами.

---

С другой стороны производительность чтения данной функции очень ужасное, каждый раз приходится сканировать весь файл на вхождение, выискивая ключ. Можно сказать, что сложность такого алгоритма O(n). При удвоении записей в БД, скорость запросов увеличится в два раза.

Для эффективного поиска значения конкретного ключа используется другая структура данных - Индекс. В этой главе будут рассмотрены различные индексы и их отличия. Общая идея индексов такова, хранения дополнительных метаданных, слушающие определенным дорожным указателем к нашим данным. При необходимости поиска одних и те же данных различными способами может понадобиться несколько разных индексов.


Индекс - дополнительная структура данных, производная от основных данных. Многие БД позволяют добавлять и изменять индексы без каких-либо влияние на данные, это влияет только на скорость запросов. Добавление новых индексов не только увеличивает размер базы, но и замедляет скорость записи на диск. Превзойти простую запись в конец файла достаточно сложно, это простейшая операция. Любой индекс замедляет запись на диск, так как ему приходится так же обновлять индекс.

Это важный момент, поэтому в БД обычно не индексируют все подряд, а заставляют разработчика или администратора БД, создавать индексы на основе знания типичных для приложения паттернов. поэтому нужно выбирать индексы, значение которых максимально.