С SS таблицами все хорошо, до тех пор, пока не придут новые записи, потому как записи могут идти в любом порядке.

Поддержание такой отсортированной структуры возможно с помощью B-дерева, но в разы проще это сделать в оперативной памяти. Существует множество доступных доступных древовидных структур данных, такие как красно-черные деревья или AVL-деревья. При использовании их, можно вставлять ключи в любом порядке, а затем читать их в нужной последовательности.

Теперь мы организуем работы нашей подсистемы следующим образом.

1. При поступлении новой записи, добавляем её в наше красно-черное дерево в оперативной памяти, обычно такие деревья называют MemTable.
2. Когда наша MemTable достигает размеров нескольких мегабайт,  мы записываем его на диск в виде SS таблицы. Это очень эффективной, наша MemTable уже имеет отсортированное значение "ключ-значение", запись произойдет быстро, если в этот момент будут поступать другие записи, мы уже будем их записывать в новый экземпляр MemTable.
3. Для обслуживания запроса на чтение, вначале смотрим в MemTable, после в последнем файле записи, затем в предпоследнем и тд. Время от времени запускаем фоновые процессы уплотнения и слияния.

Представленная схема работает отлично, есть один недостаток это случаи при фатальном сбое, записанные позже всего данные теряются. Чтобы этого избежать можно ввести неупорядоченный журнал , в конец которого добавляются все новые данные. Этот журнал нужен только для восстановления MemTable после сбоя. Сразу после записи в SS таблицы этот журнал можно удалить.