Первым недостатком сразу говорит о себе алгоритм слияния и уплотнения, иногда он способен отрицательно влиять на память или время запроса. Несмотря, что этот алгоритм работает пошагово, не влияя на конкурентный доступ к дискам, ресурсы все же ограничены. Может возникнуть ситуация, когда сам процесс уплотнения запустится, другим операциям придется ожидать время завершения уплотнения. Обычно это время не велико, но это может оказать эффект на высоких процентилях, в этом плане b-деревья более предсказуемые.

Другая проблема, уплотнение при высоких объемах. Чем объемнее LSM дерево, тем больше полосы пропускания будет забирать на себя алгоритм при уплотнении.

Если алгоритм уплотнения настроен плохо и при этом объемы велики, то может случиться так, что алгоритм не будет успевать за темпами входящих операций записи. В этом случае количество необъединенных сегментов будет расти до тех пор, пока на диске не закончится место, при этом операции чтения будут выполняться дольше, потому что потребуется просмотреть большое количество файлов сегментов. Обычно подсистемы на основе SS таблиц, не ограничивают темпы записи, но если уплотнение за ними не успевает, то для обнаружения этой ситуации потребуется доп. мониторинг.

Преимущества b-дерева заключается в том, что ключ может быть только один, а в LSM-дереве он может встречаться по нескольку раз в разных сегментах. Во многих БД изоляция транзакции реализована на блокировки для диапазона ключей, такие блокировки хорошо привязываются к b-дереву.

b-деревья сильно укоренились в архитектуре БД, они хорошо себя показывают по нагрузке и транзакциям, от них скорее всего отказываться не будут в ближайшем будущем. Новые БД местами заменяют b-деревья на журналированные индексы. Не существует универсального решения, каждый индекс надо тщательно протестировать на своей задаче, для максимального эффекта.


