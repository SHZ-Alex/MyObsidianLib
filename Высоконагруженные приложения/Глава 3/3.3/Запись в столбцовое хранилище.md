Описанные оптимизации вносят большой вклад в оптимизацию запросов с данными, но это делаете жизнь проще, только с запросами на чтение, если нужно будет добавить запись, это усложнит запрос.

Подход с обновлением данных на месте, используемый B-деревьями, невозможен в случае сжатых столбцов. При необходимости вставить строки в середине отсортированной таблицы, вероятнее всего, придется переписать все файлы столбцов.

К счастью, тут сильно помогут нам LSM-деревья. Все записывается сначала в хранилище оперативной памяти, где данные добавляются в отсортированную структуру и подготавливают к записи на диск.

Не имеет значение, является хранилище столбцовым или построчным. При накоплении достаточного количество данных они объединяются в файлы и записываются блоками в новые файлы. Именно так функционирует Vertica.

Запросы должны просматривать как столбцовые данные на диске, так и свежие данные в оперативной памяти и объединять их. Однако оптимизатор запросов скрывает это от пользователя. С точки зрения аналитики, изменяемые с помощью вставок  обновлений или удалений данные сразу же отражаются в последующих запросах.